# Automatically Generated File
# Copyright 2021 VMware, Inc. All rights reserved. VMware Confidential
---
- name: Avi ServiceEngineGroup | Create or Update ServiceEngineGroup
  no_log: "False"
  vmware.alb.avi_serviceenginegroup:

    controller: "{{ avi_controller | default(omit) }}"
    username: "{{ avi_username | default(omit) }}"
    password: "{{ avi_password | default(omit) }}"
    tenant: "{{ item.tenant | default(omit) }}"
    state: "{{ avi_role_state_mode }}"
    api_version: "{{ api_version | default(omit) }}"
    avi_credentials: "{{ avi_credentials | default(omit) }}"
    api_context: "{{ avi_api_context | default(omit) }}"
    name: "{{ item.name | default(omit) }}"
    avi_api_update_method: "{{ avi_api_update_method | default(omit) }}"
    avi_api_patch_op: "{{ item.avi_api_patch_op | default(omit) }}"
    aggressive_failure_detection: "{{ item.aggressive_failure_detection | default(omit) }}"
    allow_burst: "{{ item.allow_burst | default(omit) }}"
    app_cache_threshold: "{{ item.app_cache_threshold | default(omit) }}"
    app_learning_memory_percent: "{{ item.app_learning_memory_percent | default(omit) }}"
    archive_shm_limit: "{{ item.archive_shm_limit | default(omit) }}"
    async_ssl: "{{ item.async_ssl | default(omit) }}"
    async_ssl_threads: "{{ item.async_ssl_threads | default(omit) }}"
    auto_rebalance: "{{ item.auto_rebalance | default(omit) }}"
    auto_rebalance_capacity_per_se: "{{ item.auto_rebalance_capacity_per_se | default(omit) }}"
    auto_rebalance_criteria: "{{ item.auto_rebalance_criteria | default(omit) }}"
    auto_rebalance_interval: "{{ item.auto_rebalance_interval | default(omit) }}"
    auto_redistribute_active_standby_load: "{{ item.auto_redistribute_active_standby_load | default(omit) }}"
    availability_zone_refs: "{{ item.availability_zone_refs | default(omit) }}"
    baremetal_dispatcher_handles_flows: "{{ item.baremetal_dispatcher_handles_flows | default(omit) }}"
    bgp_peer_monitor_failover_enabled: "{{ item.bgp_peer_monitor_failover_enabled | default(omit) }}"
    bgp_state_update_interval: "{{ item.bgp_state_update_interval | default(omit) }}"
    compress_ip_rules_for_each_ns_subnet: "{{ item.compress_ip_rules_for_each_ns_subnet | default(omit) }}"
    config_debugs_on_all_cores: "{{ item.config_debugs_on_all_cores | default(omit) }}"
    configpb_attributes: "{{ item.configpb_attributes | default(omit) }}"
    core_shm_app_cache: "{{ item.core_shm_app_cache | default(omit) }}"
    core_shm_app_learning: "{{ item.core_shm_app_learning | default(omit) }}"
    custom_securitygroups_data: "{{ item.custom_securitygroups_data | default(omit) }}"
    custom_securitygroups_mgmt: "{{ item.custom_securitygroups_mgmt | default(omit) }}"
    data_network_id: "{{ item.data_network_id | default(omit) }}"
    datascript_timeout: "{{ item.datascript_timeout | default(omit) }}"
    deactivate_ipv6_discovery: "{{ item.deactivate_ipv6_discovery | default(omit) }}"
    deactivate_kni_filtering_at_dispatcher: "{{ item.deactivate_kni_filtering_at_dispatcher | default(omit) }}"
    disable_avi_securitygroups: "{{ item.disable_avi_securitygroups | default(omit) }}"
    disable_csum_offloads: "{{ item.disable_csum_offloads | default(omit) }}"
    disable_flow_probes: "{{ item.disable_flow_probes | default(omit) }}"
    disable_gro: "{{ item.disable_gro | default(omit) }}"
    disable_se_memory_check: "{{ item.disable_se_memory_check | default(omit) }}"
    disable_tso: "{{ item.disable_tso | default(omit) }}"
    distribute_load_active_standby: "{{ item.distribute_load_active_standby | default(omit) }}"
    distribute_queues: "{{ item.distribute_queues | default(omit) }}"
    distribute_vnics: "{{ item.distribute_vnics | default(omit) }}"
    downstream_send_timeout: "{{ item.downstream_send_timeout | default(omit) }}"
    dp_aggressive_deq_interval_msec: "{{ item.dp_aggressive_deq_interval_msec | default(omit) }}"
    dp_aggressive_enq_interval_msec: "{{ item.dp_aggressive_enq_interval_msec | default(omit) }}"
    dp_aggressive_hb_frequency: "{{ item.dp_aggressive_hb_frequency | default(omit) }}"
    dp_aggressive_hb_timeout_count: "{{ item.dp_aggressive_hb_timeout_count | default(omit) }}"
    dp_deq_interval_msec: "{{ item.dp_deq_interval_msec | default(omit) }}"
    dp_enq_interval_msec: "{{ item.dp_enq_interval_msec | default(omit) }}"
    dp_hb_frequency: "{{ item.dp_hb_frequency | default(omit) }}"
    dp_hb_timeout_count: "{{ item.dp_hb_timeout_count | default(omit) }}"
    dpdk_gro_timeout_interval: "{{ item.dpdk_gro_timeout_interval | default(omit) }}"
    enable_gratarp_permanent: "{{ item.enable_gratarp_permanent | default(omit) }}"
    enable_hsm_log: "{{ item.enable_hsm_log | default(omit) }}"
    enable_hsm_priming: "{{ item.enable_hsm_priming | default(omit) }}"
    enable_multi_lb: "{{ item.enable_multi_lb | default(omit) }}"
    enable_pcap_tx_ring: "{{ item.enable_pcap_tx_ring | default(omit) }}"
    ephemeral_portrange_end: "{{ item.ephemeral_portrange_end | default(omit) }}"
    ephemeral_portrange_start: "{{ item.ephemeral_portrange_start | default(omit) }}"
    extra_config_multiplier: "{{ item.extra_config_multiplier | default(omit) }}"
    flow_table_new_syn_max_entries: "{{ item.flow_table_new_syn_max_entries | default(omit) }}"
    free_list_size: "{{ item.free_list_size | default(omit) }}"
    gratarp_permanent_periodicity: "{{ item.gratarp_permanent_periodicity | default(omit) }}"
    grpc_channel_connect_timeout: "{{ item.grpc_channel_connect_timeout | default(omit) }}"
    handle_per_pkt_attack: "{{ item.handle_per_pkt_attack | default(omit) }}"
    hardwaresecuritymodulegroup_ref: "{{ item.hardwaresecuritymodulegroup_ref | default(omit) }}"
    heap_minimum_config_memory: "{{ item.heap_minimum_config_memory | default(omit) }}"
    hm_on_standby: "{{ item.hm_on_standby | default(omit) }}"
    host_attribute_key: "{{ item.host_attribute_key | default(omit) }}"
    host_attribute_value: "{{ item.host_attribute_value | default(omit) }}"
    host_gateway_monitor: "{{ item.host_gateway_monitor | default(omit) }}"
    http_rum_console_log: "{{ item.http_rum_console_log | default(omit) }}"
    http_rum_min_content_length: "{{ item.http_rum_min_content_length | default(omit) }}"
    hybrid_rss_mode: "{{ item.hybrid_rss_mode | default(omit) }}"
    hypervisor: "{{ item.hypervisor | default(omit) }}"
    ignore_docker_mac_change: "{{ item.ignore_docker_mac_change | default(omit) }}"
    ignore_rtt_threshold: "{{ item.ignore_rtt_threshold | default(omit) }}"
    ingress_access_data: "{{ item.ingress_access_data | default(omit) }}"
    ingress_access_mgmt: "{{ item.ingress_access_mgmt | default(omit) }}"
    instance_flavor_info: "{{ item.instance_flavor_info | default(omit) }}"
    iptables: "{{ item.iptables | default(omit) }}"
    l7_conns_per_core: "{{ item.l7_conns_per_core | default(omit) }}"
    l7_resvd_listen_conns_per_core: "{{ item.l7_resvd_listen_conns_per_core | default(omit) }}"
    labels: "{{ item.labels | default(omit) }}"
    lbaction_num_requests_to_dispatch: "{{ item.lbaction_num_requests_to_dispatch | default(omit) }}"
    lbaction_rq_per_request_max_retries: "{{ item.lbaction_rq_per_request_max_retries | default(omit) }}"
    least_load_core_selection: "{{ item.least_load_core_selection | default(omit) }}"
    license_tier: "{{ item.license_tier | default(omit) }}"
    log_agent_compress_logs: "{{ item.log_agent_compress_logs | default(omit) }}"
    log_agent_debug_enabled: "{{ item.log_agent_debug_enabled | default(omit) }}"
    log_agent_file_sz_appl: "{{ item.log_agent_file_sz_appl | default(omit) }}"
    log_agent_file_sz_conn: "{{ item.log_agent_file_sz_conn | default(omit) }}"
    log_agent_file_sz_debug: "{{ item.log_agent_file_sz_debug | default(omit) }}"
    log_agent_file_sz_event: "{{ item.log_agent_file_sz_event | default(omit) }}"
    log_agent_log_storage_min_sz: "{{ item.log_agent_log_storage_min_sz | default(omit) }}"
    log_agent_max_concurrent_rsync: "{{ item.log_agent_max_concurrent_rsync | default(omit) }}"
    log_agent_max_storage_excess_percent: "{{ item.log_agent_max_storage_excess_percent | default(omit) }}"
    log_agent_max_storage_ignore_percent: "{{ item.log_agent_max_storage_ignore_percent | default(omit) }}"
    log_agent_min_storage_per_vs: "{{ item.log_agent_min_storage_per_vs | default(omit) }}"
    log_agent_sleep_interval: "{{ item.log_agent_sleep_interval | default(omit) }}"
    log_agent_trace_enabled: "{{ item.log_agent_trace_enabled | default(omit) }}"
    log_agent_unknown_vs_timer: "{{ item.log_agent_unknown_vs_timer | default(omit) }}"
    log_disksz: "{{ item.log_disksz | default(omit) }}"
    log_malloc_failure: "{{ item.log_malloc_failure | default(omit) }}"
    log_message_max_file_list_size: "{{ item.log_message_max_file_list_size | default(omit) }}"
    realtime_se_metrics: "{{ item.realtime_se_metrics | default(omit) }}"
    ha_mode: "{{ item.ha_mode | default(omit) }}"
    algo: "{{ item.algo | default(omit) }}"
    max_vs_per_se: "{{ item.max_vs_per_se | default(omit) }}"
    self_se_election: "{{ item.self_se_election | default(omit) }}"
    max_se: "{{ item.max_se | default(omit) }}"
    extra_shared_config_memory: "{{ item.extra_shared_config_memory | default(omit) }}"
    app_cache_percent: "{{ item.app_cache_percent | default(omit) }}"
    connection_memory_percentage: "{{ item.connection_memory_percentage | default(omit) }}"
    license_type: "{{ item.license_type | default(omit) }}"
    per_app: "{{ item.per_app | default(omit) }}"
    se_bandwidth_type: "{{ item.se_bandwidth_type | default(omit) }}"
    max_num_se_dps: "{{ item.max_num_se_dps | default(omit) }}"
    use_hyperthreaded_cores: "{{ item.use_hyperthreaded_cores | default(omit) }}"
    buffer_se: "{{ item.buffer_se | default(omit) }}"
    cloud_ref: "{{ item.cloud_ref | default(omit) }}"
    max_scaleout_per_vs: "{{ item.max_scaleout_per_vs | default(omit) }}"
    cpu_socket_affinity: "{{ item.cpu_socket_affinity | default(omit) }}"
    dedicated_dispatcher_core: "{{ item.dedicated_dispatcher_core | default(omit) }}"
    non_significant_log_throttle: "{{ item.non_significant_log_throttle | default(omit) }}"
    significant_log_throttle: "{{ item.significant_log_throttle | default(omit) }}"
    udf_log_throttle: "{{ item.udf_log_throttle | default(omit) }}"
    uuid: "{{ item.uuid | default(omit) }}"
    vcenter_clusters: "{{ item.vcenter_clusters | default(omit) }}"
    vcenter_datastore_mode: "{{ item.vcenter_datastore_mode | default(omit) }}"
    vcenter_datastores: "{{ item.vcenter_datastores | default(omit) }}"
    vcenter_datastores_include: "{{ item.vcenter_datastores_include | default(omit) }}"
    vcenter_folder: "{{ item.vcenter_folder | default(omit) }}"
    vcenter_hosts: "{{ item.vcenter_hosts | default(omit) }}"
    vcenter_parking_vnic_pg: "{{ item.vcenter_parking_vnic_pg | default(omit) }}"
    vcenters: "{{ item.vcenters | default(omit) }}"
    vcpus_per_se: "{{ item.vcpus_per_se | default(omit) }}"
    custom_tag: "{{ item.custom_tag | default(omit) }}"
    se_name_prefix: "{{ item.se_name_prefix | default(omit) }}"
    accelerated_networking: "{{ item.accelerated_networking | default(omit) }}"
    active_standby: "{{ item.active_standby | default(omit) }}"
    instance_flavor: "{{ item.instance_flavor | default(omit) }}"
    se_deprovision_delay: "{{ item.se_deprovision_delay | default(omit) }}"
    memory_per_se: "{{ item.memory_per_se | default(omit) }}"
    disk_per_se: "{{ item.disk_per_se | default(omit) }}"
    cpu_reserve: "{{ item.cpu_reserve | default(omit) }}"
    mem_reserve: "{{ item.mem_reserve | default(omit) }}"
    description: "{{ item.description | default(omit) }}"
    tenant_ref: "{{ item.tenant_ref | default(omit) }}"
    gcp_config: "{{ item.gcp_config | default(omit) }}"
    markers: "{{ item.markers | default(omit) }}"
    max_concurrent_external_hm: "{{ item.max_concurrent_external_hm | default(omit) }}"
    max_cpu_usage: "{{ item.max_cpu_usage | default(omit) }}"
    max_memory_per_mempool: "{{ item.max_memory_per_mempool | default(omit) }}"
    max_public_ips_per_lb: "{{ item.max_public_ips_per_lb | default(omit) }}"
    max_queues_per_vnic: "{{ item.max_queues_per_vnic | default(omit) }}"
    max_rules_per_lb: "{{ item.max_rules_per_lb | default(omit) }}"
    memory_for_config_update: "{{ item.memory_for_config_update | default(omit) }}"
    mgmt_network_ref: "{{ item.mgmt_network_ref | default(omit) }}"
    mgmt_subnet: "{{ item.mgmt_subnet | default(omit) }}"
    min_cpu_usage: "{{ item.min_cpu_usage | default(omit) }}"
    min_scaleout_per_vs: "{{ item.min_scaleout_per_vs | default(omit) }}"
    min_se: "{{ item.min_se | default(omit) }}"
    minimum_connection_memory: "{{ item.minimum_connection_memory | default(omit) }}"
    n_log_streaming_threads: "{{ item.n_log_streaming_threads | default(omit) }}"
    ns_helper_deq_interval_msec: "{{ item.ns_helper_deq_interval_msec | default(omit) }}"
    num_dispatcher_cores: "{{ item.num_dispatcher_cores | default(omit) }}"
    num_dispatcher_queues: "{{ item.num_dispatcher_queues | default(omit) }}"
    ntp_sync_fail_event: "{{ item.ntp_sync_fail_event | default(omit) }}"
    ntp_sync_status_interval: "{{ item.ntp_sync_status_interval | default(omit) }}"
    objsync_config: "{{ item.objsync_config | default(omit) }}"
    objsync_port: "{{ item.objsync_port | default(omit) }}"
    openstack_availability_zones: "{{ item.openstack_availability_zones | default(omit) }}"
    openstack_mgmt_network_name: "{{ item.openstack_mgmt_network_name | default(omit) }}"
    openstack_mgmt_network_uuid: "{{ item.openstack_mgmt_network_uuid | default(omit) }}"
    os_reserved_memory: "{{ item.os_reserved_memory | default(omit) }}"
    per_vs_admission_control: "{{ item.per_vs_admission_control | default(omit) }}"
    placement_mode: "{{ item.placement_mode | default(omit) }}"
    replay_vrf_routes_interval: "{{ item.replay_vrf_routes_interval | default(omit) }}"
    reboot_on_panic: "{{ item.reboot_on_panic | default(omit) }}"
    resync_time_interval: "{{ item.resync_time_interval | default(omit) }}"
    sdb_flush_interval: "{{ item.sdb_flush_interval | default(omit) }}"
    sdb_pipeline_size: "{{ item.sdb_pipeline_size | default(omit) }}"
    sdb_scan_count: "{{ item.sdb_scan_count | default(omit) }}"
    se_delayed_flow_delete: "{{ item.se_delayed_flow_delete | default(omit) }}"
    se_dos_profile: "{{ item.se_dos_profile | default(omit) }}"
    se_dp_hm_drops: "{{ item.se_dp_hm_drops | default(omit) }}"
    se_dp_if_state_poll_interval: "{{ item.se_dp_if_state_poll_interval | default(omit) }}"
    se_dp_isolation: "{{ item.se_dp_isolation | default(omit) }}"
    se_dp_isolation_num_non_dp_cpus: "{{ item.se_dp_isolation_num_non_dp_cpus | default(omit) }}"
    se_dp_log_nf_enqueue_percent: "{{ item.se_dp_log_nf_enqueue_percent | default(omit) }}"
    se_dp_log_udf_enqueue_percent: "{{ item.se_dp_log_udf_enqueue_percent | default(omit) }}"
    se_dpdk_pmd: "{{ item.se_dpdk_pmd | default(omit) }}"
    se_emulated_cores: "{{ item.se_emulated_cores | default(omit) }}"
    se_hyperthreaded_mode: "{{ item.se_hyperthreaded_mode | default(omit) }}"
    se_lro: "{{ item.se_lro | default(omit) }}"
    se_mtu: "{{ item.se_mtu | default(omit) }}"
    se_use_dpdk: "{{ item.se_use_dpdk | default(omit) }}"
    use_dp_util_for_scaleout: "{{ item.use_dp_util_for_scaleout | default(omit) }}"
    use_objsync: "{{ item.use_objsync | default(omit) }}"
    use_standard_alb: "{{ item.use_standard_alb | default(omit) }}"
    user_agent_cache_config: "{{ item.user_agent_cache_config | default(omit) }}"
    vs_host_redundancy: "{{ item.vs_host_redundancy | default(omit) }}"
    vs_scalein_timeout: "{{ item.vs_scalein_timeout | default(omit) }}"
    vs_scalein_timeout_for_upgrade: "{{ item.vs_scalein_timeout_for_upgrade | default(omit) }}"
    vs_scaleout_timeout: "{{ item.vs_scaleout_timeout | default(omit) }}"
    vs_se_scaleout_additional_wait_time: "{{ item.vs_se_scaleout_additional_wait_time | default(omit) }}"
    vs_se_scaleout_ready_timeout: "{{ item.vs_se_scaleout_ready_timeout | default(omit) }}"
    vs_switchover_timeout: "{{ item.vs_switchover_timeout | default(omit) }}"
  with_items: "{{ avi_role_cfg.serviceenginegroup | default([]) }}"
  when:
    - (avi_role_state_mode == "present" and avi_config_state == "present")
    - (item.state | default("present") == avi_role_state_mode or avi_config_state == "absent")